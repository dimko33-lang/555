<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SR Visualization</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
body { margin:0; background:#000833; overflow:hidden; font-family: Arial, sans-serif; }
canvas { display:block; position: absolute; top: 0; left: 0; z-index: 1; }
.controls { position: fixed; top: 10px; right: 10px; display: flex; gap: 6px; z-index: 100; }
.btn { width: 44px; height: 44px; border-radius: 5px; background: rgba(0,0,0,0.7); border:1px solid rgba(255,255,255,0.3); color:white; font-size:22px; cursor:pointer; display:flex; align-items:center; justify-content:center; }
.btn:hover { background: rgba(50,50,50,0.9); }
.info-panel { position: fixed; top:10px; left:10px; background: rgba(0,0,0,0.7); color:white; padding:0 15px; border-radius:5px; font-size:14px; border:1px solid rgba(255,255,255,0.2); min-width:200px; height:44px; z-index:100; display:flex; flex-direction:column; justify-content:center; }
.info-item { margin:0; display:flex; justify-content:space-between; align-items:center; }
.info-label { color:#aaa; font-size:11px; }
.info-value { font-weight:bold; font-family:'Courier New', monospace; }
.speed-value { color:#fa0; font-size:14px; }
.gamma-value { color:#0ff; font-size:14px; }
body.light-mode { background: #fff; }
body.light-mode .btn { background: rgba(255,255,255,0.7); color:#000; border:1px solid rgba(0,0,0,0.3); }
body.light-mode .info-panel { background: rgba(255,255,255,0.9); color:#000; border:1px solid rgba(0,0,0,0.2); }
body.light-mode .info-label { color:#666; }
</style>
</head>
<body>
<canvas id="c"></canvas>

<div class="info-panel" id="infoPanel">
  <div class="info-item"><span class="info-label">Speed:</span><span class="info-value speed-value" id="speedValue">0.000c</span></div>
  <div class="info-item"><span class="info-label">Î³:</span><span class="info-value gamma-value" id="gammaValue">1.000</span></div>
</div>

<div class="controls">
  <button class="btn" id="euclidBtn">E</button>
  <button class="btn" id="hyperBtn">H</button>
  <button class="btn" id="sphereBtn">S</button>
  <button class="btn" id="negBtn">â˜€</button>
  <button class="btn" id="zoomReset">â†»</button>
  <button class="btn" id="fullscreen">â›¶</button>
</div>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
let scale = 0.3, offsetX = 0, offsetY = 0, angle = 0;
let darkMode = true, currentGeometry = "euclidean";

// --- ÐºÐ½Ð¾Ð¿ÐºÐ¸ ---
document.getElementById('euclidBtn').onclick = ()=>{ currentGeometry="euclidean"; }
document.getElementById('hyperBtn').onclick = ()=>{ currentGeometry="hyperbolic"; }
document.getElementById('sphereBtn').onclick = ()=>{ currentGeometry="spherical"; }
document.getElementById('negBtn').onclick = ()=>{
  darkMode = !darkMode;
  document.body.classList.toggle('light-mode', !darkMode);
  document.getElementById('negBtn').textContent = darkMode?'â˜€':'ðŸŒ™';
};
document.getElementById('zoomReset').onclick = ()=>{
  scale = 0.3; offsetX = canvas.width/2; offsetY = canvas.height/2;
};
document.getElementById('fullscreen').onclick = ()=>{
  if(!document.fullscreenElement) document.documentElement.requestFullscreen();
  else document.exitFullscreen();
};

// --- resize ---
function resize(){ canvas.width=window.innerWidth; canvas.height=window.innerHeight; offsetX=canvas.width/2; offsetY=canvas.height/2; }
window.addEventListener('resize', resize);
resize();

// --- Ð¿Ñ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚ ---
function toScreen(x,y){ return {x:x*scale+offsetX, y:y*scale+offsetY}; }
function getColor(dark,light){ return darkMode?dark:light; }
function drawLine(x1,y1,x2,y2,dark,light,width=1){ const p1=toScreen(x1,y1); const p2=toScreen(x2,y2); ctx.strokeStyle=getColor(dark,light); ctx.lineWidth=width; ctx.beginPath(); ctx.moveTo(p1.x,p1.y); ctx.lineTo(p2.x,p2.y); ctx.stroke(); }
function drawPoint(x,y,r,dark,light){ const p=toScreen(x,y); ctx.fillStyle=getColor(dark,light); ctx.beginPath(); ctx.arc(p.x,p.y,r,0,2*Math.PI); ctx.fill(); }
function drawText(text,x,y,dark,light,font=10,align="center"){ if(scale<0.5)return; const p=toScreen(x,y); ctx.font=`${font}px Arial`; ctx.fillStyle=getColor(dark,light); ctx.textAlign=align; ctx.textBaseline="middle"; ctx.fillText(text,p.x,p.y); }

// --- Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ ---
function updateInfo(v=0){
  document.getElementById('speedValue').textContent=v.toFixed(3)+"c";
  let gamma = 1/Math.sqrt(1-v*v);
  document.getElementById('gammaValue').textContent=gamma.toFixed(3);
}

// --- Ñ€Ð¸ÑÐ¾Ð²ÐºÐ¸ ---
function drawEuclidean(){
  ctx.fillStyle = darkMode?"#000833":"#fff"; ctx.fillRect(0,0,canvas.width,canvas.height);
  drawText("Euclidean",20,20,"#0ff","#08f",20,"left");
  
  // ÐºÑ€ÐµÑÑ‚ ÐºÐ°Ðº Ð² Ñ‚Ð²Ð¾ÐµÐ¼ ÐºÐ¾Ð´Ðµ
  const len = 300;
  const cosA=Math.cos(angle), sinA=Math.sin(angle);
  drawLine(-len,0,len,0,"#0ff","#08f",2);
  drawLine(0,-len,0,len,"#888","#666",2);
  const cx=0, cy=0;
  drawPoint(cx,cy,4,"#fff","#000");
  updateInfo(Math.sin(angle));
}

function drawHyperbolic(){
  ctx.fillStyle = darkMode?"#001122":"#eef"; ctx.fillRect(0,0,canvas.width,canvas.height);
  drawText("Hyperbolic (Poincare Disk)",20,20,"#0ff","#08f",20,"left");
  
  // Ð´Ð¸ÑÐº ÐŸÑƒÐ°Ð½ÐºÐ°Ñ€Ðµ
  const r = 200;
  const steps = 36;
  for(let i=0;i<steps;i++){
    const theta = 2*Math.PI*i/steps;
    const x = r*Math.cos(theta);
    const y = r*Math.sin(theta);
    drawPoint(x,y,3,"#0ff","#08f");
  }
  
  // Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð½Ð°Ð±Ð»ÑŽÐ´Ð°Ñ‚ÐµÐ»ÑŒ
  drawPoint(0,0,6,"#fff","#000");
  updateInfo(Math.sin(angle)*0.8); // Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¿Ñ€Ð¸Ð¼ÐµÑ€ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚Ð¸
}

function drawSpherical(){
  ctx.fillStyle = darkMode?"#110000":"#fee"; ctx.fillRect(0,0,canvas.width,canvas.height);
  drawText("Spherical (Light Sphere)",20,20,"#0ff","#08f",20,"left");
  
  // ÑÐ²ÐµÑ‚Ð¾Ð²Ð°Ñ ÑÑ„ÐµÑ€Ð°
  const r = 200;
  const steps = 30;
  for(let i=0;i<steps;i++){
    const phi = Math.PI*i/steps;
    for(let j=0;j<steps;j++){
      const theta = 2*Math.PI*j/steps;
      const x = r*Math.sin(phi)*Math.cos(theta);
      const y = r*Math.sin(phi)*Math.sin(theta);
      drawPoint(x,y,2,"#0ff","#08f");
    }
  }
  drawPoint(0,0,6,"#fff","#000");
  updateInfo(Math.sin(angle)*0.5);
}

// --- Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¼Ñ‹ÑˆÐ¸ ---
let dragging=false,lastX=0;
canvas.addEventListener("pointerdown",e=>{ dragging=true; lastX=e.clientX; });
canvas.addEventListener("pointermove",e=>{ if(dragging){ angle+= (e.clientX-lastX)*0.01; lastX=e.clientX; } });
canvas.addEventListener("pointerup",()=>dragging=false);
canvas.addEventListener("pointerleave",()=>dragging=false);

// --- Ð³Ð»Ð°Ð²Ð½Ñ‹Ð¹ Ñ†Ð¸ÐºÐ» ---
function drawScene(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  if(currentGeometry==="euclidean") drawEuclidean();
  else if(currentGeometry==="hyperbolic") drawHyperbolic();
  else if(currentGeometry==="spherical") drawSpherical();
  requestAnimationFrame(drawScene);
}

drawScene();
</script>
</body>
</html>
